{
  "version": 1,
  "protocol_constants": {
    "magic": "0x59414950",
    "max_payload": 65536,
    "header_size": 96
  },
  "cases": [
    {
      "id": "T-001-VALID-HANDSHAKE",
      "description": "Scenario standard: handshake corretto",
      "envelope": {
        "magic": "0x59414950",
        "version": 1,
        "ws_id": "ws-default-001",
        "command_id": 258,
        "payload_len": 24
      },
      "payload": "{\"caps\": 1, \"role\": \"op\"}",
      "expected": "RX_ACCEPTED",
      "action": "RPC_REPLY_OK"
    },
    {
      "id": "T-002-BAD-MAGIC",
      "description": "Attacco/Errore: Magic number errato (0xDEADBEEF)",
      "envelope": {
        "magic": "0xDEADBEEF",
        "version": 1,
        "ws_id": "ws-default-001",
        "command_id": 258,
        "payload_len": 0
      },
      "expected": "RX_REJECTED",
      "action": "DROP_CONNECTION",
      "audit_reason": "bad_magic"
    },
    {
      "id": "T-003-PAYLOAD-OVERSIZE",
      "description": "Attacco DoS: Payload superiore al limite di 64KB",
      "envelope": {
        "magic": "0x59414950",
        "version": 1,
        "ws_id": "ws-default-001",
        "command_id": 513,
        "payload_len": 70000
      },
      "expected": "RX_REJECTED",
      "action": "AUDIT_LOG_REJECT",
      "audit_reason": "oversize_payload"
    },
    {
      "id": "T-004-PRIVILEGED-UNARMED",
      "description": "Violazione Logica: Comando critico senza bit 'arming'",
      "envelope": {
        "magic": "0x59414950",
        "version": 1,
        "ws_id": "ws-default-001",
        "command_id": 61699,
        "arming": 0,
        "role": 1,
        "payload_len": 0
      },
      "expected": "DENY_UNARMED",
      "action": "AUDIT_LOG_REJECT"
    }
  ]
}